<html>
<head>
<link rel="stylesheet" href="styles/vendor.css">
<link rel="stylesheet" href="styles/alchemy.min.css">
<link rel="stylesheet" href="styles/nzrs.css">
</head>
  <body>
    <div class="alchemy" id="alchemy"></div>

    <script src="scripts/vendor.js"></script>
    <script src="scripts/alchemy.js"></script>
    <script src="/d3/d3.min.js"></script>
    <script type="text/javascript">

        var deg_domain = [1, 250];

        var radius = d3.scale.log()
                .domain(deg_domain)
                .range([5, 60]);

        var border = d3.scale.linear()
                .domain(deg_domain)
                .range([2, 8]);

        var node_color = {
            'other': d3.scale.linear()
                        .domain(deg_domain)
                        .range(['#62ED4C', '#0C3806']),
            'IX':    d3.scale.linear()
                        .domain(deg_domain)
                        .range(['#FF1F1F', '#7A0000']),
            'AU':    d3.scale.linear()
                        .domain(deg_domain)
                        .range(['#FFE20A', '#A39000']),
            'NZ':    d3.scale.linear()
                        .domain(deg_domain)
                        .range(['#707070', 'black']),
            'priv':  d3.scale.linear()
                        .domain(deg_domain)
                        .range(['lightblue', 'blue']),
        }

        var config = {
            dataSource: 'data/nz-bgp-map.alchemy.json',
            nodeTypes: { "country": ["AU", "NZ", "IX", "priv", "other"] },
            cluster: false,
            nodeCaption: function(n) { return n.name + "(" + n.id + ")"; },
            nodeRadius: function(n) { return radius(n.degree); },
            nodeStrike: function(n) { return border(n.degree); },
            nodeColour: function(n) { return node_color[n.country](n.degree); },
            linkDistance: function(edge, k) { return 15; },
            preLoad: function() {
                // There is extra info in the input file we could use to
                // set the right domain for the color scales
                this.preLoad.caller.arguments[0].dr.forEach(function(d) {
                    if (node_color[d.country]) {
                        node_color[d.country].domain([d.min, d.max])
                    }
                });
            },
            zoomControls: true,
            showFilters: true,
            showControlDash: true,
            nodeFilters: true,
            };

        alchemy.begin(config)
    </script>
  </body>
</html>
